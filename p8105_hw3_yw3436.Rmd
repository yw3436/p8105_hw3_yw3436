---
title: "Homework 3"
author: Yuqi Wang
output: github_document
---

This is my question for HW3.

```{r}
library(tidyverse)
library(p8105.datasets)

## add more in this part
```

## Problem 1

First, load the data set.
```{r}
data("instacart")
```

This dataset contains `r nrow(instacart)` rows and `r ncol(instacart)` columns.

Observations are the level of items in orders by users. there are user/order variables, including user ID, order ID, order day, and order hour. There are also item variables, including name, aisles, department, and some numeric codes. 

How many aisles and which are most items from?

```{r}
count_aisle = instacart %>% 
  count(aisle) %>% 
  arrange(desc(n))
```

There are `r nrow(count_aisle)` aisles and fresh vegetables are most items from.

Make a plot

```{r}
count_aisle %>% 
  filter(n > 10000) %>% 
  mutate(
    aisle = factor(aisle),
    aisle = fct_reorder(aisle, n)
    # this function is used to reorder aisle according to n; factor() is close to as.factor(), check with ?help.
  ) %>% 
  ggplot(aes(x = aisle, y = n)) + 
  geom_point() + 
  theme(axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1))
```

Making a table showing the most popular items

```{r}
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  #use max_rank
  filter(rank < 4) %>% 
  arrange(aisle, desc(n)) %>% 
  knitr::kable()
```

Apple vs ice cream.

```{r}
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  )
```



